<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta lang="ja" />
    <title>チャレンジャーズ - 配信</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@300..700&display=swap" rel="stylesheet">
    <link href = "common.css" rel = "stylesheet" type = "text/css" />
    <link href = "live-common.css" rel = "stylesheet" type = "text/css" />
</head>
<body>
    <div id = "live-info">
        <div id = "total">
            <div id = "total-title">TOTAL</div>
            <div id = "total-value" class = "slide-box"></div>
            <div id = "total-bar"></div>
            <div id = "total-perfect">50</div>
        </div>
        <div id = "detail">
            <div id = "margin"></div>
            <div id = "red" class = "slide-box"></div>
            <div id = "yellow" class = "slide-box"></div>
            <div id = "blue" class = "slide-box"></div>
            <div id = "tennis" class = "slide-box"></div>
            <div id = "wrong-color" class = "slide-box"></div>
        </div>
        <div id = "retry">
            <div id = "retry-title">RETRY</div>
            <div id = "retry-value" class = "slide-box"></div>
        </div>
    </div>
</body>
<script src = "newDom.js"></script>
<script type="text/javascript">
    nodecg.Replicant("pointC").on("change", (newVal, oldVal) => {
        const newRedDiv = document.createElement("div");
        if (oldVal == undefined || newVal.red != oldVal.red) {
            newRedDiv.textContent = newVal.red * 3 + " (" + newVal.red + ")";
            showNextDom(document.getElementById("red"), newRedDiv);
        }

        const newYellowDiv = document.createElement("div");
        if (oldVal == undefined || newVal.yellow != oldVal.yellow) {
            newYellowDiv.textContent = newVal.yellow * 3 + " (" + newVal.yellow + ")";
            showNextDom(document.getElementById("yellow"), newYellowDiv);
        }

        const newBlueDiv = document.createElement("div");
        if (oldVal == undefined || newVal.blue != oldVal.blue) {
            newBlueDiv.textContent = newVal.blue * 3 + " (" + newVal.blue + ")";
            showNextDom(document.getElementById("blue"), newBlueDiv);
        }

        if (oldVal == undefined || newVal.tennis != oldVal.tennis) {
            const newTennisDiv = document.createElement("div");
            newTennisDiv.textContent = newVal.tennis * 5 + " (" + newVal.tennis + ")";
            showNextDom(document.getElementById("tennis"), newTennisDiv);
        }

        if (oldVal == undefined || newVal.wrongColor != oldVal.wrongColor) {
            const newWrongColorDiv = document.createElement("div");
            newWrongColorDiv.textContent = newVal.wrongColor + " (" + newVal.wrongColor + ")";
            showNextDom(document.getElementById("wrong-color"), newWrongColorDiv);
        }

        if (oldVal == undefined || newVal.retry != oldVal.retry) {
            const newRetryDiv = document.createElement("div");
            newRetryDiv.textContent = newVal.retry;
            showNextDom(document.getElementById("retry-value"), newRetryDiv);
        }

        if (oldVal == undefined || newVal.red != oldVal.red || newVal.yellow != oldVal.yellow || newVal.blue != oldVal.blue || newVal.tennis != oldVal.tennis || newVal.wrongColor != oldVal.wrongColor) {
            const newTotalDiv = document.createElement("div");
            newTotalDiv.textContent = parseInt(newVal.red) * 3 + parseInt(newVal.yellow) * 3 + parseInt(newVal.blue) * 3 + parseInt(newVal.tennis) * 5 + parseInt(newVal.wrongColor);
            showNextDom(document.getElementById("total-value"), newTotalDiv);
        }
    });
</script>
</html>
